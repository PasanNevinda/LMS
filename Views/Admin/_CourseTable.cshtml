@using LMS.ViewModels.Admin_ViewModels
@model CourseTableVm

<!-- Courses Table -->
<div class="data-table">
    <div class="table-responsive">
        <table class="table mb-0">
            <thead>
                <tr>
                    <th><i class="bi bi-image me-1"></i>Course</th>
                    <th><i class="bi bi-person me-1"></i>Instructor</th>
                    <th><i class="bi bi-tags me-1"></i>Category</th>
                    <th><i class="bi bi-currency-dollar me-1"></i>Price</th>
                    <th><i class="bi bi-circle-fill me-1"></i>Status</th>
                    <th><i class="bi bi-calendar-check me-1"></i>Submitted</th>
                    <th><i class="bi bi-gear me-1"></i>Actions</th>
                </tr>
            </thead>
            <tbody id="coursesTableBody">

                @foreach(var course in Model.Courses)
                {
                    
                    <tr data-course-id="@course.Id">
                        <td>
                            <div class="d-flex align-items-center">
                                @if (!string.IsNullOrEmpty(course.ImgUrl))
                                {
                                    <img src="~/@course.ImgUrl" 
                                         class="rounded me-3 course-thumbnail" 
                                         alt="@course.Name" 
                                         style="width: 60px; height: 45px; object-fit: cover; flex-shrink: 0;"
                                         data-bs-toggle="tooltip" 
                                         title="@course.Name">
                                }
                                else
                                {
                                    <div class="bg-light d-flex align-items-center justify-content-center rounded me-3" 
                                         style="width: 60px; height: 45px; flex-shrink: 0;">
                                        <i class="bi bi-image text-muted"></i>
                                    </div>
                                }
                                <div>
                                    <h6 class="mb-0">@course.Name</h6>
                                    <small class="text-muted">tags (implement later)<i class="bi bi-translate me-1"></i> @course.Language</small>
                                </div>
                            </div>
                        </td>
                        <td>@course.TeacherName <br><small class="text-muted"><i class="bi bi-envelope me-1"></i>@course.TeacherEmail</small></td>
                        <td><span class="badge bg-primary"><i class="bi bi-code-slash me-1"></i>@course.Category</span></td>
                        <td><strong>$@course.Price</strong></td>
                        <td><span class="status-badge status-pending">@course.Status</span></td>
                        <td>@course.Submitted <br><small class="text-muted">###</small></td>
                        <td>
                            <div class="btn-group" role="group">
                                <button class="btn btn-sm btn-primary-custom" data-bs-toggle="tooltip" title="View Details" onclick="reviewCourse(1)">
                                    <i class="bi bi-eye"></i>
                                </button>
                                <button class="btn btn-sm btn-success-custom" data-bs-toggle="tooltip" title="Approve" onclick="approveCourse(1)">
                                    <i class="bi bi-check-lg"></i>
                                </button>
                                <button class="btn btn-sm btn-danger-custom" data-bs-toggle="tooltip" title="Reject with Notes" onclick="rejectCourse(1)">
                                    <i class="bi bi-x-lg"></i>
                                </button>
                                <button class="btn btn-sm btn-outline-warning" data-bs-toggle="tooltip" title="Request Changes" onclick="requestChanges(1)">
                                    <i class="bi bi-pencil"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                }

                
                
            </tbody>
        </table>
    </div>
</div>

@* <!-- Pagination -->
<div class="d-flex justify-content-between align-items-center mt-4">
    <span class="text-muted"><i class="bi bi-list-ul me-1"></i>Showing 1 to 100 of @Model.Pager.TotalItems results</span>
    <nav aria-label="Course pagination">
        <ul class="pagination">
            <li class="page-item disabled"><a class="page-link" href="#"><i class="bi bi-chevron-left"></i> Previous</a></li>
            <li class="page-item active"><a class="page-link" href="#">1</a></li>
            <li class="page-item"><a class="page-link" href="#">2</a></li>
            <li class="page-item"><a class="page-link" href="#">3</a></li>
            <li class="page-item"><a class="page-link" href="#">Next <i class="bi bi-chevron-right"></i></a></li>
        </ul>
    </nav>
</div> *@

<!-- Pagination -->
<div class="d-flex justify-content-between align-items-center mt-4">
    @{
        var startItem = (Model.Pager.CurrentPage - 1) * Model.Pager.PageSize + 1;
        var endItem = Math.Min(startItem + Model.Pager.PageSize - 1, Model.Pager.TotalItems);
    }
    <span class="text-muted"><i class="bi bi-list-ul me-1"></i>Showing @startItem to @endItem of @Model.Pager.TotalItems results</span>
    <nav aria-label="Course pagination">
        <ul class="pagination">
            @if(Model.Pager.CurrentPage > 1)
            {
                <li class="page-item">
                    <a class="page-link" onclick="loadCourses(@Model.Pager.CurrentPage - 1)")>
                        <i class="bi bi-chevron-left"></i> Previous
                    </a>
                </li>
            }
         
            @for (int p = Model.Pager.StartPage; p <= Model.Pager.EndPage; p++)
            {
                <li class="page-item @(p == Model.Pager.CurrentPage ? "active" : "")">
                    <a class="page-link" onclick="loadCourses(@p); return false;">@p</a>
                </li>
            }

            @if(Model.Pager.CurrentPage != Model.Pager.TotalPages)
            {
                <li class="page-item @(Model.Pager.CurrentPage >= Model.Pager.TotalPages ? "disabled" : "")">
                    <a class="page-link" onclick="loadCourses(@Model.Pager.CurrentPage + 1)")>
                        Next <i class="bi bi-chevron-right"></i>
                    </a>
                </li>
            }
        </ul>
    </nav>
</div>